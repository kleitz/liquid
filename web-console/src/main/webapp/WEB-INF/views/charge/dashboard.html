<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Liquid</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!-- Bootstrap -->
    <link href="/resources/css/bootstrap-3.0.0.css" rel="stylesheet" media="screen"/>
    <link href="/resources/css/liquid.css" rel="stylesheet"/>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/resources/assets/js/html5shiv.js"></script>
    <script src="/resources/assets/js/respond.min.js"></script>
    <![endif]-->

    <style>
        div#routeSec.container {
        max-width: 50px;
        }

        div#chargeSec.container {
        max-width: 600px;
        }
    </style>
</head>

<body>
<!-- {!begin layout} -->
<div th:include="layout :: header"></div>
<!-- {!end layout} -->

<br/>

<div class="container">
    <div class="row">
        <div class="col-lg-7">
            <!-- charges for this leg -->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <strong th:text="#{route} + ${leg.route.id}">Route No.</strong>
                    <span th:text="#{${transModes[leg.transMode]}}"></span>
                    <span th:text="${leg.srcLoc.name} + '-' + ${leg.dstLoc.name}"></span>
                    <span th:text="#{container.quantity} + '(' + ${leg.route.containerQty}+ ')'"></span>

                    <a href="/task/{taskId}/leg/{legId}/charge" class="btn btn-default btn-xs pull-right"
                       th:href="${backToTask}">
                        <i class="glyphicon glyphicon-arrow-left"/>
                    </a>
                </div>

                <div class="panel-body">
                    <table class="table table-striped table-hover table-condensed table-16"
                           th:unless="${#lists.isEmpty(charges)}">
                        <thead>
                        <tr>
                            <th th:text="#{charge.type}">Type</th>
                            <th th:text="#{sp.name}">SP Name</th>
                            <th th:text="#{charge.way}">Way</th>
                            <th th:text="#{charge.unit.price}">Unit Price</th>
                            <th th:text="#{charge.total.price}">Total Price</th>
                            <th></th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="charge : ${charges}">
                            <!-- NOTE: Very important expression -->
                            <td th:text="${charge.type.name}">Type</td>
                            <td th:text="${charge.sp.name}">SP Name</td>
                            <td th:text="#{${chargeWays[__${charge.way}__].i18nKey}}">Way</td>
                            <td th:text="${charge.unitPrice}">Unit Price</td>
                            <td th:text="${charge.totalPrice}">Total Price</td>
                            <td>
                                <a href="/task/{taskId}/leg/{legId}/charge/{chargeId}"
                                   class="btn btn-default btn-xs pull-right"
                                   th:href="'/task/' + ${taskId} + '/leg/' + ${leg.id} + '/charge/' + ${charge.id} ">
                                    <i class="glyphicon glyphicon-minus"/>
                                </a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
        </div>

        <div class="col-lg-5">
            <div class="panel panel-default">
                <div class="panel-heading" th:text="#{charge.add}">Add Charge</div>
                <div class="panel-body">
                    <form action="/task/{taskId}/leg/{legId}/charge" method="POST" class="form-horizontal"
                          th:object="${charge}" th:action="@{${#httpServletRequest.servletPath}}">
                        <input type="text"/><input id="getSp" type="button"/>

                        <div class="form-group">
                            <label th:text="#{charge.type}" class="col-lg-3 control-label">Charge Type</label>

                            <div class="col-lg-9">
                                <select th:field="*{typeId}" class="form-control">
                                    <option th:each="ct : ${cts}"
                                            th:value="${ct.key}"
                                            th:text="${ct.value}">Charge Type
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-lg-3 control-label" th:text="#{sp}">SP</label>

                            <div class="col-lg-9">
                                <select th:field="*{spId}" class="form-control">
                                    <option th:each="sp : ${sps}"
                                            th:value="${sp.id}"
                                            th:text="${sp.name}">SP Name
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label th:text="#{charge.way}" class="col-lg-3 control-label">Charge Way</label>

                            <div class="col-lg-9">
                                <ul class="list-inline">
                                    <li th:each="chargeWay : ${chargeWays}">
                                        <input type="radio" th:field="*{way}" th:value="${chargeWay.value}"/>
                                        <label th:for="${#ids.prev('way')}"
                                               th:text="#{${chargeWay.i18nKey}}">Charge Way</label>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div class="form-group">
                            <label th:text="#{charge.unit.price}" class="col-lg-3 control-label">Unit Price</label>

                            <div class="col-lg-9">
                                <input type="text" th:field="*{unitPrice}" class="form-control"/>
                            </div>

                            <span th:errors="*{unitPrice}">error</span>
                        </div>

                        <div class="form-group">
                            <label th:text="#{charge.total.price}" class="col-lg-3 control-label">Total Price</label>

                            <div class="col-lg-9">
                                <input type="text" th:field="*{totalPrice}" class="form-control"/>
                            </div>

                            <span th:errors="*{totalPrice}">error</span>
                        </div>

                        <input type="hidden" name="taskId" th:value="${task.id}" value="0"/>

                        <div class="form-group">
                            <div class="col-lg-offset-3 col-lg-9">
                                <input type="submit" value="Record" class="btn btn-default"
                                       th:attr="value=#{charge.record}"/>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /.container -->


<!-- {!begin layout} -->
<div th:include="layout :: footer"></div>
<!-- {!end layout} -->

<!-- {!begin layout} -->
<div th:include="layout :: js"></div>
<!-- {!end layout} -->

<script>
    $(document).ready(function() {
    $("#getSp").click(function() {
    $.ajax({
    url: '/sp?type=2',
    type: 'GET',
    success: function (result) {
    alert("result" + result);
    }
    });
    });
    });
</script>
</body>

</html>
